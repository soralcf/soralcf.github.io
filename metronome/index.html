<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="&#x2F;* ËäÇÊãçÂô®Ê†∑Âºè *&#x2F; #metronome-app * {     margin: 0;     padding: 0;     box-sizing: border-box; }  #metronome-app {    ‚Äìmetro-primary: #3498db;    ‚Äìmetro-accent: #e74c3c;    ‚Äìmetro-bg: #f5f7fa;    ‚Äìmetro-">
<meta property="og:type" content="article">
<meta property="og:title" content="metronome">
<meta property="og:url" content="https://soralcf.github.io/metronome/index.html">
<meta property="og:site_name" content="SoralCF">
<meta property="og:description" content="&#x2F;* ËäÇÊãçÂô®Ê†∑Âºè *&#x2F; #metronome-app * {     margin: 0;     padding: 0;     box-sizing: border-box; }  #metronome-app {    ‚Äìmetro-primary: #3498db;    ‚Äìmetro-accent: #e74c3c;    ‚Äìmetro-bg: #f5f7fa;    ‚Äìmetro-">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-01-12T12:25:55.000Z">
<meta property="article:modified_time" content="2026-01-11T17:09:06.486Z">
<meta property="article:author" content="soralcf">
<meta property="article:tag" content="music">
<meta property="article:tag" content="metronome">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/favicon.ico" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
        
      
    
    <!-- title -->
    <title>metronome</title>
    <!-- async scripts -->
    <!-- Google Analytics -->

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CZ9N7MDJ5H"></script>
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CZ9N7MDJ5H');
  </script>


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/soralcf?tab=repositories">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/my-2024/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://soralcf.github.io/metronome/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://soralcf.github.io/metronome/&text=metronome"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://soralcf.github.io/metronome/&is_video=false&description=metronome"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=metronome&body=Check out this article: https://soralcf.github.io/metronome/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://soralcf.github.io/metronome/&name=metronome&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://soralcf.github.io/metronome/&t=metronome"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#metronome-app"><span class="toc-number">1.</span> <span class="toc-text">üéµ Âú®Á∫øËäÇÊãçÂô®</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        metronome
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">soralcf</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-01-12T12:25:55.000Z" class="dt-published" itemprop="datePublished">Jan 12 2025</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/music/">music</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/metronome/" rel="tag">metronome</a>, <a class="p-category" href="/tags/music/" rel="tag">music</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <div id="metronome-app">
<style>
/* ËäÇÊãçÂô®Ê†∑Âºè */
#metronome-app * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

<p>#metronome-app {<br>    ‚Äìmetro-primary: #3498db;<br>    ‚Äìmetro-accent: #e74c3c;<br>    ‚Äìmetro-bg: #f5f7fa;<br>    ‚Äìmetro-card: #ffffff;<br>    ‚Äìmetro-text: #2c3e50;<br>    ‚Äìmetro-gray-light: #ecf0f1;<br>    ‚Äìmetro-gray-medium: #95a5a6;<br>    ‚Äìmetro-radius: 12px;<br>    ‚Äìmetro-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);<br>    ‚Äìmetro-shadow-hover: 0 4px 16px rgba(0, 0, 0, 0.12);<br>    font-family: -apple-system, BlinkMacSystemFont, ‚ÄúSegoe UI‚Äù, Roboto, sans-serif;<br>    margin: 30px 0;<br>}</p>
<p>.metronome-container {<br>    background: var(‚Äìmetro-card);<br>    border-radius: var(‚Äìmetro-radius);<br>    box-shadow: var(‚Äìmetro-shadow);<br>    padding: 40px;<br>    width: 100%;<br>    max-width: 480px;<br>    margin: 0 auto;<br>}</p>
<p>.metronome-header {<br>    text-align: center;<br>    margin-bottom: 30px;<br>}</p>
<p>.metronome-title {<br>    font-size: 24px;<br>    font-weight: 600;<br>    color: var(‚Äìmetro-text);<br>    display: flex;<br>    align-items: center;<br>    justify-content: center;<br>    gap: 10px;<br>}</p>
<p>.metro-bpm-display {<br>    text-align: center;<br>    margin-bottom: 25px;<br>}</p>
<p>.metro-bpm-value {<br>    font-size: 72px;<br>    font-weight: 700;<br>    color: var(‚Äìmetro-primary);<br>    line-height: 1;<br>    font-family: ‚ÄòRoboto Mono‚Äô, monospace;<br>    margin-bottom: 5px;<br>}</p>
<p>.metro-bpm-label {<br>    font-size: 14px;<br>    color: var(‚Äìmetro-gray-medium);<br>    text-transform: uppercase;<br>    letter-spacing: 2px;<br>}</p>
<p>.metro-bpm-controls {<br>    display: flex;<br>    align-items: center;<br>    justify-content: center;<br>    gap: 10px;<br>    margin-bottom: 20px;<br>}</p>
<p>.metro-bpm-btn {<br>    width: 44px;<br>    height: 44px;<br>    border: none;<br>    background: var(‚Äìmetro-primary);<br>    color: white;<br>    font-size: 20px;<br>    border-radius: 8px;<br>    cursor: pointer;<br>    transition: all 0.3s ease;<br>    display: flex;<br>    align-items: center;<br>    justify-content: center;<br>}</p>
<p>.metro-bpm-btn:hover {<br>    background: #2980b9;<br>    transform: translateY(-2px);<br>}</p>
<p>.metro-bpm-input {<br>    width: 100px;<br>    height: 44px;<br>    border: 2px solid var(‚Äìmetro-gray-light);<br>    border-radius: 8px;<br>    font-size: 20px;<br>    font-weight: 600;<br>    text-align: center;<br>    color: var(‚Äìmetro-text);<br>    transition: all 0.3s ease;<br>}</p>
<p>.metro-bpm-input:focus {<br>    outline: none;<br>    border-color: var(‚Äìmetro-primary);<br>}</p>
<p>.metro-preset-buttons {<br>    display: flex;<br>    justify-content: center;<br>    gap: 8px;<br>    margin-bottom: 20px;<br>    flex-wrap: wrap;<br>}</p>
<p>.metro-preset-btn {<br>    padding: 8px 16px;<br>    border: 2px solid var(‚Äìmetro-gray-light);<br>    background: white;<br>    color: var(‚Äìmetro-text);<br>    border-radius: 6px;<br>    font-size: 13px;<br>    font-weight: 500;<br>    cursor: pointer;<br>    transition: all 0.3s ease;<br>}</p>
<p>.metro-preset-btn:hover {<br>    border-color: var(‚Äìmetro-primary);<br>    color: var(‚Äìmetro-primary);<br>}</p>
<p>.metro-time-signature {<br>    text-align: center;<br>    margin-bottom: 25px;<br>}</p>
<p>.metro-time-sig-label {<br>    font-size: 13px;<br>    color: var(‚Äìmetro-gray-medium);<br>    margin-bottom: 10px;<br>    text-transform: uppercase;<br>    letter-spacing: 1px;<br>}</p>
<p>.metro-time-sig-buttons {<br>    display: flex;<br>    justify-content: center;<br>    gap: 8px;<br>}</p>
<p>.metro-time-sig-btn {<br>    width: 60px;<br>    height: 40px;<br>    border: 2px solid var(‚Äìmetro-gray-light);<br>    background: white;<br>    color: var(‚Äìmetro-text);<br>    border-radius: 8px;<br>    font-size: 14px;<br>    font-weight: 600;<br>    cursor: pointer;<br>    transition: all 0.3s ease;<br>}</p>
<p>.metro-time-sig-btn:hover {<br>    border-color: var(‚Äìmetro-primary);<br>    color: var(‚Äìmetro-primary);<br>}</p>
<p>.metro-time-sig-btn.active {<br>    background: var(‚Äìmetro-primary);<br>    color: white;<br>    border-color: var(‚Äìmetro-primary);<br>}</p>
<p>.metro-beat-indicators {<br>    display: flex;<br>    justify-content: center;<br>    gap: 12px;<br>    margin-bottom: 25px;<br>    min-height: 60px;<br>    align-items: center;<br>}</p>
<p>.metro-beat-dot {<br>    width: 40px;<br>    height: 40px;<br>    border-radius: 50%;<br>    background: var(‚Äìmetro-gray-light);<br>    transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);<br>}</p>
<p>.metro-beat-dot.active {<br>    transform: scale(1.3);<br>}</p>
<p>.metro-beat-dot.strong-beat {<br>    background: var(‚Äìmetro-accent);<br>}</p>
<p>.metro-beat-dot.weak-beat {<br>    background: var(‚Äìmetro-primary);<br>}</p>
<p>.metro-play-button {<br>    width: 100%;<br>    padding: 16px;<br>    border: none;<br>    background: var(‚Äìmetro-primary);<br>    color: white;<br>    font-size: 18px;<br>    font-weight: 600;<br>    border-radius: 8px;<br>    cursor: pointer;<br>    transition: all 0.3s ease;<br>    display: flex;<br>    align-items: center;<br>    justify-content: center;<br>    gap: 10px;<br>}</p>
<p>.metro-play-button:hover {<br>    background: #2980b9;<br>    transform: translateY(-2px);<br>    box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);<br>}</p>
<p>.metro-play-button.playing {<br>    background: var(‚Äìmetro-accent);<br>}</p>
<p>.metro-play-button.playing:hover {<br>    background: #c0392b;<br>    box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);<br>}</p>
<p>.metro-status-tip {<br>    text-align: center;<br>    margin-top: 20px;<br>    padding: 12px;<br>    background: var(‚Äìmetro-gray-light);<br>    border-radius: 8px;<br>    font-size: 13px;<br>    color: var(‚Äìmetro-gray-medium);<br>}</p>
<p>.metro-status-tip kbd {<br>    display: inline-block;<br>    padding: 2px 6px;<br>    background: white;<br>    border: 1px solid #ddd;<br>    border-radius: 4px;<br>    font-family: monospace;<br>    font-size: 12px;<br>    margin: 0 2px;<br>}</p>
<p>@media (max-width: 480px) {<br>    .metronome-container {<br>        padding: 24px;<br>    }</p>
<pre><code>.metro-bpm-value &#123;
    font-size: 56px;
&#125;

.metro-bpm-controls &#123;
    flex-wrap: wrap;
&#125;

.metro-preset-buttons &#123;
    gap: 6px;
&#125;

.metro-preset-btn &#123;
    padding: 6px 12px;
    font-size: 12px;
&#125;

.metro-time-sig-buttons &#123;
    flex-wrap: wrap;
&#125;

.metro-beat-dot &#123;
    width: 32px;
    height: 32px;
&#125;
</code></pre>
<p>}<br></style></p>
<div class="metronome-container">
    <div class="metronome-header">
        <h1 class="metronome-title">üéµ Âú®Á∫øËäÇÊãçÂô®</h1>
    </div>

<pre><code>&lt;div class=&quot;metro-bpm-display&quot;&gt;
    &lt;div class=&quot;metro-bpm-value&quot; id=&quot;metroBpmValue&quot;&gt;120&lt;/div&gt;
    &lt;div class=&quot;metro-bpm-label&quot;&gt;BPM&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;metro-bpm-controls&quot;&gt;
    &lt;button class=&quot;metro-bpm-btn&quot; id=&quot;metroBpmDown&quot;&gt;‚àí&lt;/button&gt;
    &lt;input type=&quot;number&quot; class=&quot;metro-bpm-input&quot; id=&quot;metroBpmInput&quot; value=&quot;120&quot; min=&quot;40&quot; max=&quot;208&quot;&gt;
    &lt;button class=&quot;metro-bpm-btn&quot; id=&quot;metroBpmUp&quot;&gt;+&lt;/button&gt;
&lt;/div&gt;

&lt;div class=&quot;metro-preset-buttons&quot;&gt;
    &lt;button class=&quot;metro-preset-btn&quot; data-bpm=&quot;60&quot;&gt;60 ÊÖ¢Êùø&lt;/button&gt;
    &lt;button class=&quot;metro-preset-btn&quot; data-bpm=&quot;80&quot;&gt;80 Ë°åÊùø&lt;/button&gt;
    &lt;button class=&quot;metro-preset-btn&quot; data-bpm=&quot;120&quot;&gt;120 Âø´Êùø&lt;/button&gt;
    &lt;button class=&quot;metro-preset-btn&quot; data-bpm=&quot;168&quot;&gt;168 ÊÄ•Êùø&lt;/button&gt;
&lt;/div&gt;

&lt;div class=&quot;metro-time-signature&quot;&gt;
    &lt;div class=&quot;metro-time-sig-label&quot;&gt;ÊãçÂè∑&lt;/div&gt;
    &lt;div class=&quot;metro-time-sig-buttons&quot;&gt;
        &lt;button class=&quot;metro-time-sig-btn&quot; data-beats=&quot;2&quot;&gt;2/4&lt;/button&gt;
        &lt;button class=&quot;metro-time-sig-btn&quot; data-beats=&quot;3&quot;&gt;3/4&lt;/button&gt;
        &lt;button class=&quot;metro-time-sig-btn active&quot; data-beats=&quot;4&quot;&gt;4/4&lt;/button&gt;
        &lt;button class=&quot;metro-time-sig-btn&quot; data-beats=&quot;6&quot;&gt;6/8&lt;/button&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;metro-beat-indicators&quot; id=&quot;metroBeatIndicators&quot;&gt;
    &lt;div class=&quot;metro-beat-dot&quot; data-beat=&quot;1&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;metro-beat-dot&quot; data-beat=&quot;2&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;metro-beat-dot&quot; data-beat=&quot;3&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;metro-beat-dot&quot; data-beat=&quot;4&quot;&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;button class=&quot;metro-play-button&quot; id=&quot;metroPlayButton&quot;&gt;
    &lt;span id=&quot;metroPlayIcon&quot;&gt;‚ñ∂&lt;/span&gt;
    &lt;span id=&quot;metroPlayText&quot;&gt;ÂºÄÂßãÊí≠Êîæ&lt;/span&gt;
&lt;/button&gt;

&lt;div class=&quot;metro-status-tip&quot;&gt;
    üí° ÊèêÁ§∫: Êåâ &lt;kbd&gt;Á©∫Ê†ºÈîÆ&lt;/kbd&gt; ÂèØÂø´ÈÄüÂêØÂÅú
&lt;/div&gt;
</code></pre>
</div>

<script>
(function() {
    // ËäÇÊãçÂô®ÂºïÊìé
    class MetronomeEngine {
        constructor() {
            this.audioContext = null;
            this.nextNoteTime = 0.0;
            this.timerID = null;
            this.tempo = 120;
            this.lookahead = 25.0;
            this.scheduleAheadTime = 0.1;
            this.currentBeat = 0;
            this.beatsPerBar = 4;
            this.isPlaying = false;
        }

        initAudioContext() {
            if (!this.audioContext) {
                this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (this.audioContext.state === 'suspended') {
                this.audioContext.resume();
            }
        }

        playBeat(isStrong, time) {
            const osc = this.audioContext.createOscillator();
            const gainNode = this.audioContext.createGain();

            osc.connect(gainNode);
            gainNode.connect(this.audioContext.destination);

            const frequency = isStrong ? 1000 : 600;
            const volume = isStrong ? 0.5 : 0.25;

            osc.frequency.value = frequency;
            gainNode.gain.setValueAtTime(volume, time);
            gainNode.gain.exponentialRampToValueAtTime(0.001, time + 0.05);

            osc.start(time);
            osc.stop(time + 0.05);
        }

        nextNote() {
            const secondsPerBeat = 60.0 / this.tempo;
            this.nextNoteTime += secondsPerBeat;

            this.currentBeat++;
            if (this.currentBeat > this.beatsPerBar) {
                this.currentBeat = 1;
            }
        }

        scheduleNote(beatNumber, time) {
            const isStrong = (beatNumber === 1);
            this.playBeat(isStrong, time);

            const drawTime = (time - this.audioContext.currentTime) * 1000;
            setTimeout(() => {
                requestAnimationFrame(() => {
                    metroUpdateVisuals(beatNumber, isStrong);
                });
            }, drawTime);
        }

        scheduler() {
            while (this.nextNoteTime < this.audioContext.currentTime + this.scheduleAheadTime) {
                this.scheduleNote(this.currentBeat, this.nextNoteTime);
                this.nextNote();
            }
            this.timerID = setTimeout(() => this.scheduler(), this.lookahead);
        }

        start() {
            if (this.isPlaying) return;
            this.initAudioContext();
            this.isPlaying = true;
            this.currentBeat = 1;
            this.nextNoteTime = this.audioContext.currentTime + 0.05;
            this.scheduler();
            metroUpdatePlayButton(true);
        }

        stop() {
            this.isPlaying = false;
            clearTimeout(this.timerID);
            metroUpdatePlayButton(false);
            metroResetVisuals();
        }

        setTempo(bpm) {
            this.tempo = Math.max(40, Math.min(208, bpm));
        }

        setBeatsPerBar(beats) {
            this.beatsPerBar = beats;
            this.currentBeat = 1;
        }

        getTempo() {
            return this.tempo;
        }
    }

    const metronome = new MetronomeEngine();
    const bpmValue = document.getElementById('metroBpmValue');
    const bpmInput = document.getElementById('metroBpmInput');
    const bpmUp = document.getElementById('metroBpmUp');
    const bpmDown = document.getElementById('metroBpmDown');
    const presetButtons = document.querySelectorAll('.metro-preset-btn');
    const timeSigButtons = document.querySelectorAll('.metro-time-sig-btn');
    const beatIndicators = document.getElementById('metroBeatIndicators');
    const playButton = document.getElementById('metroPlayButton');
    const playText = document.getElementById('metroPlayText');
    const playIcon = document.getElementById('metroPlayIcon');

    function metroUpdateBPM(bpm) {
        bpmValue.textContent = bpm;
        bpmInput.value = bpm;
        metronome.setTempo(bpm);
        metroSaveSettings();
    }

    function metroUpdateVisuals(beatNumber, isStrong) {
        const dots = document.querySelectorAll('.metro-beat-dot');
        dots.forEach(dot => {
            dot.classList.remove('active', 'strong-beat', 'weak-beat');
        });

        const activeDot = document.querySelector(`.metro-beat-dot[data-beat="${beatNumber}"]`);
        if (activeDot) {
            activeDot.classList.add('active');
            activeDot.classList.add(isStrong ? 'strong-beat' : 'weak-beat');
        }
    }

    function metroResetVisuals() {
        const dots = document.querySelectorAll('.metro-beat-dot');
        dots.forEach(dot => {
            dot.classList.remove('active', 'strong-beat', 'weak-beat');
        });
    }

    function metroUpdatePlayButton(isPlaying) {
        if (isPlaying) {
            playButton.classList.add('playing');
            playText.textContent = 'ÊöÇÂÅú';
            playIcon.textContent = '‚è∏';
        } else {
            playButton.classList.remove('playing');
            playText.textContent = 'ÂºÄÂßãÊí≠Êîæ';
            playIcon.textContent = '‚ñ∂';
        }
    }

    function metroUpdateBeatIndicators(beats) {
        beatIndicators.innerHTML = '';
        for (let i = 1; i <= beats; i++) {
            const dot = document.createElement('div');
            dot.className = 'metro-beat-dot';
            dot.setAttribute('data-beat', i);
            beatIndicators.appendChild(dot);
        }
    }

    bpmInput.addEventListener('change', () => {
        let bpm = parseInt(bpmInput.value);
        bpm = Math.max(40, Math.min(208, bpm));
        metroUpdateBPM(bpm);
    });

    bpmUp.addEventListener('click', () => {
        const current = metronome.getTempo();
        metroUpdateBPM(Math.min(208, current + 1));
    });

    bpmDown.addEventListener('click', () => {
        const current = metronome.getTempo();
        metroUpdateBPM(Math.max(40, current - 1));
    });

    presetButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            const bpm = parseInt(btn.getAttribute('data-bpm'));
            metroUpdateBPM(bpm);
        });
    });

    timeSigButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            const beats = parseInt(btn.getAttribute('data-beats'));
            timeSigButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            metronome.setBeatsPerBar(beats);
            metroUpdateBeatIndicators(beats);
            metroSaveSettings();
        });
    });

    playButton.addEventListener('click', () => {
        if (metronome.isPlaying) {
            metronome.stop();
        } else {
            metronome.start();
        }
    });

    document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') {
            e.preventDefault();
            if (metronome.isPlaying) {
                metronome.stop();
            } else {
                metronome.start();
            }
        }

        if (e.code === 'ArrowUp') {
            e.preventDefault();
            const current = metronome.getTempo();
            metroUpdateBPM(Math.min(208, current + 1));
        }

        if (e.code === 'ArrowDown') {
            e.preventDefault();
            const current = metronome.getTempo();
            metroUpdateBPM(Math.max(40, current - 1));
        }
    });

    const METRO_STORAGE_KEY = 'metronome-settings';

    function metroSaveSettings() {
        const settings = {
            bpm: metronome.getTempo(),
            beatsPerBar: metronome.beatsPerBar
        };
        localStorage.setItem(METRO_STORAGE_KEY, JSON.stringify(settings));
    }

    function metroLoadSettings() {
        const saved = localStorage.getItem(METRO_STORAGE_KEY);
        if (saved) {
            try {
                const settings = JSON.parse(saved);

                if (settings.bpm) {
                    metroUpdateBPM(settings.bpm);
                }

                if (settings.beatsPerBar) {
                    metronome.setBeatsPerBar(settings.beatsPerBar);
                    metroUpdateBeatIndicators(settings.beatsPerBar);

                    timeSigButtons.forEach(btn => {
                        btn.classList.remove('active');
                        if (parseInt(btn.getAttribute('data-beats')) === settings.beatsPerBar) {
                            btn.classList.add('active');
                        }
                    });
                }
            } catch (e) {
                console.error('Âä†ËΩΩËäÇÊãçÂô®ËÆæÁΩÆÂ§±Ë¥•:', e);
            }
        }
    }

    metroLoadSettings();

    document.addEventListener('mousedown', (e) => {
        if (e.target.closest('#metronome-app') && e.detail > 1) {
            e.preventDefault();
        }
    }, false);
})();
</script>
</div>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a target="_blank" rel="noopener" href="http://github.com/soralcf?tab=repositories">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#metronome-app"><span class="toc-number">1.</span> <span class="toc-text">üéµ Âú®Á∫øËäÇÊãçÂô®</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://soralcf.github.io/metronome/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://soralcf.github.io/metronome/&text=metronome"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://soralcf.github.io/metronome/&is_video=false&description=metronome"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=metronome&body=Check out this article: https://soralcf.github.io/metronome/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://soralcf.github.io/metronome/&title=metronome"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://soralcf.github.io/metronome/&name=metronome&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://soralcf.github.io/metronome/&t=metronome"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2025-2026
    soralcf
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="http://github.com/soralcf?tab=repositories">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
